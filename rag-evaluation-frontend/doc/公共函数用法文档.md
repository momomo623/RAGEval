## 1. 如何使用系统配置

### 1.1 访问配置按钮

配置按钮可以添加到任何页面，点击后打开配置模态窗口：

```tsx
import ConfigButton from '../components/ConfigButton';

// 在页面中使用
<ConfigButton text="系统配置" type="primary" />

// 或使用无文本图标按钮
<ConfigButton icon={true} text="" type="link" />
```

### 1.2 在代码中访问配置

使用提供的Context钩子获取配置：

```tsx
import { useConfigContext } from '../contexts/ConfigContext';

const YourComponent = () => {
  // 获取配置上下文
  const { getLLMConfig, getRAGConfig } = useConfigContext();
  
  // 在需要使用时获取最新配置
  const handleAction = () => {
    const llmConfig = getLLMConfig();
    const ragConfig = getRAGConfig();
    
    if (llmConfig && ragConfig) {
      // 使用配置进行操作
      console.log('使用配置:', llmConfig, ragConfig);
    } else {
      // 提示用户需要配置
    }
  };
  
  return (
    // ...组件内容
  );
};
```

### 1.3 使用LLM配置示例

```typescript
// 导入OpenAI客户端
import OpenAI from 'openai';
import { useConfigContext } from '../contexts/ConfigContext';

// 在组件中使用
const { getLLMConfig } = useConfigContext();
const llmConfig = getLLMConfig();

// 如果配置存在，创建客户端实例
if (llmConfig) {
  const openai = new OpenAI({
    apiKey: llmConfig.apiKey,
    baseURL: llmConfig.baseUrl,
    dangerouslyAllowBrowser: true // 仅在前端直接调用时需要
  });
  
  // 使用客户端进行API调用
  const completion = await openai.chat.completions.create({
    model: llmConfig.modelName,
    messages: [
      { role: "user", content: "你好，请问..." }
    ],
    ...llmConfig.additionalParams // 应用任何额外参数
  });
  
  console.log(completion.choices[0]?.message?.content);
}
```

### 1.4 使用RAG系统配置示例

```typescript
import { useConfigContext } from '../contexts/ConfigContext';

// 在组件中使用
const { getRAGConfig } = useConfigContext();
const ragConfig = getRAGConfig();

// 如果配置存在，准备API调用
if (ragConfig) {
  // 解析存储的配置
  const headers = JSON.parse(ragConfig.requestHeaders);
  const requestTemplate = JSON.parse(ragConfig.requestTemplate);
  
  // 替换请求模板中的占位符
  const userQuestion = "这是一个测试问题";
  const requestBody = JSON.stringify(
    JSON.parse(
      JSON.stringify(requestTemplate).replace('{{question}}', userQuestion)
    )
  );
  
  // 发送请求
  const response = await fetch(ragConfig.url, {
    method: 'POST',
    headers,
    body: requestBody,
  });
  
  if (response.ok) {
    const data = await response.json();
    
    // 从响应中提取答案
    const paths = ragConfig.responsePath.split('.');
    let result = data;
    for (const path of paths) {
      if (result && result[path] !== undefined) {
        result = result[path];
      } else {
        console.error('无法从响应中提取答案');
        break;
      }
    }
    
    console.log('RAG系统回答:', result);
  }
}
```

### 1.5 配置状态检查

在评测相关页面，建议检查配置状态并提供相应提示：

```tsx
import { Alert } from 'antd';
import { useConfigContext } from '../contexts/ConfigContext';
import ConfigButton from '../components/ConfigButton';

const EvaluationPage = () => {
  const { getLLMConfig, getRAGConfig } = useConfigContext();
  const isConfigured = !!getLLMConfig() && !!getRAGConfig();
  
  return (
    <div>
      {!isConfigured && (
        <Alert
          message="系统未完全配置"
          description="请先配置大模型API和RAG系统接口，以进行评测"
          type="warning"
          action={<ConfigButton text="立即配置" type="primary" size="small" />}
          showIcon
        />
      )}
      
      {/* 页面其他内容 */}
    </div>
  );
};
```

## 3. 隐私和安全考虑

- 所有配置数据仅存储在用户的浏览器本地存储中
- API密钥和其他敏感信息不会发送到后端服务器
- API请求直接从用户浏览器发送至相应的服务提供商
- 提供清除功能，允许用户随时删除存储的配置

## 4. 技术实现

系统配置功能基于以下主要组件实现：

- **ConfigModal**: 配置模态窗口组件
- **ConfigButton**: 用于打开配置模态窗口的按钮组件
- **ConfigContext**: 全局配置上下文提供器
- **useConfig**: 自定义钩子，提供配置访问方法

所有这些组件协同工作，提供一个无缝的配置管理体验，同时确保数据私密性和安全性。
