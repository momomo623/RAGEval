# RAG评测系统 API 接口文档（详细版）

## 目录
1. [认证 API](#1-认证-api)
2. [用户 API](#2-用户-api)
3. [数据集 API](#3-数据集-api) [新增]
4. [项目 API](#4-项目-api)
5. [问题 API](#5-问题-api)
6. [RAG回答 API](#6-rag回答-api)
7. [评测 API](#7-评测-api)
8. [自动评测 API](#8-自动评测-api)
9. [人工评测 API](#9-人工评测-api)
10. [报告 API](#10-报告-api)
11. [性能测试 API](#11-性能测试-api)

所有API路径前缀: `/api/v1`

---

## 1. 认证 API

### 1.1 用户登录
- **路径**: `/auth/login`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "email": "user@example.com",  // 用户邮箱，必填
    "password": "userpassword"       // 用户密码，必填
  }
  ```
- **响应**:
  ```json
  {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",  // JWT访问令牌
    "token_type": "bearer"                                      // 令牌类型
  }
  ```
- **错误响应**:
  - `401 Unauthorized`: 用户名或密码错误
  ```json
  {
    "detail": "用户名或密码错误"
  }
  ```

### 1.2 用户注册
- **路径**: `/auth/register`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "email": "user@example.com",  // 用户邮箱，必填，唯一
    "password": "userpassword",   // 用户密码，必填，至少8个字符
    "name": "用户名称",           // 用户名称，可选
    "company": "公司名称",        // 公司名称，可选
    "bio": "个人简介",            // 个人简介，可选
    "avatar_url": "头像URL"       // 头像URL，可选
  }
  ```
- **响应**:
  ```json
  {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",  // JWT访问令牌
    "token_type": "bearer"                                      // 令牌类型
  }
  ```
- **错误响应**:
  - `400 Bad Request`: 邮箱已被注册
  ```json
  {
    "detail": "该邮箱已被注册"
  }
  ```

---

## 2. 用户 API

### 2.1 获取所有用户
- **路径**: `/users`
- **方法**: `GET`
- **查询参数**:
  - `skip`: 跳过记录数，整数，默认0
  - `limit`: 返回记录数，整数，默认100
- **权限**: 仅管理员
- **响应**:
  ```json
  [
    {
      "id": "uuid字符串",
      "email": "user@example.com",
      "name": "用户名称",
      "company": "公司名称",
      "bio": "个人简介",
      "avatar_url": "头像URL",
      "is_active": true,
      "is_admin": false,
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```
- **错误响应**:
  - `403 Forbidden`: 权限不足
  ```json
  {
    "detail": "权限不足"
  }
  ```

### 2.2 创建新用户
- **路径**: `/users`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "email": "user@example.com",  // 用户邮箱，必填，唯一
    "password": "userpassword",   // 用户密码，必填
    "name": "用户名称",           // 用户名称，可选
    "company": "公司名称",        // 公司名称，可选
    "bio": "个人简介",            // 个人简介，可选
    "avatar_url": "头像URL",      // 头像URL，可选
    "is_active": true,            // 是否激活，布尔值，默认true
    "is_admin": false             // 是否管理员，布尔值，默认false
  }
  ```
- **权限**: 仅管理员
- **响应**: 创建的用户信息
  ```json
  {
    "id": "uuid字符串",
    "email": "user@example.com",
    "name": "用户名称",
    "company": "公司名称",
    "bio": "个人简介",
    "avatar_url": "头像URL",
    "is_active": true,
    "is_admin": false,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `400 Bad Request`: 邮箱已被注册
  - `403 Forbidden`: 权限不足

### 2.3 获取当前用户信息
- **路径**: `/users/me`
- **方法**: `GET`
- **响应**: 当前用户信息
  ```json
  {
    "id": "uuid字符串",
    "email": "user@example.com",
    "name": "用户名称",
    "company": "公司名称",
    "bio": "个人简介",
    "avatar_url": "头像URL",
    "is_active": true,
    "is_admin": false,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```

### 2.4 更新当前用户信息
- **路径**: `/users/me`
- **方法**: `PUT`
- **请求体**: 用户更新信息（所有字段均为可选）
  ```json
  {
    "password": "newpassword",    // 新密码，可选
    "name": "新用户名称",         // 新用户名称，可选
    "email": "newemail@example.com", // 新邮箱，可选
    "company": "新公司名称",      // 新公司名称，可选
    "bio": "新个人简介",          // 新个人简介，可选
    "avatar_url": "新头像URL"     // 新头像URL，可选
  }
  ```
- **响应**: 更新后的用户信息
  ```json
  {
    "id": "uuid字符串",
    "email": "newemail@example.com",
    "name": "新用户名称",
    "company": "新公司名称",
    "bio": "新个人简介",
    "avatar_url": "新头像URL",
    "is_active": true,
    "is_admin": false,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```

### 2.5 获取指定用户信息
- **路径**: `/users/{user_id}`
- **方法**: `GET`
- **路径参数**:
  - `user_id`: 用户ID，UUID字符串
- **响应**: 用户信息
  ```json
  {
    "id": "uuid字符串",
    "email": "user@example.com",
    "name": "用户名称",
    "company": "公司名称",
    "bio": "个人简介",
    "avatar_url": "头像URL",
    "is_active": true,
    "is_admin": false,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 用户未找到
  - `403 Forbidden`: 权限不足（非管理员只能查看自己的信息）

### 2.6 更新指定用户信息
- **路径**: `/users/{user_id}`
- **方法**: `PUT`
- **路径参数**:
  - `user_id`: 用户ID，UUID字符串
- **请求体**: 用户更新信息（所有字段均为可选）
  ```json
  {
    "password": "newpassword",    // 新密码，可选
    "name": "新用户名称",         // 新用户名称，可选
    "email": "newemail@example.com", // 新邮箱，可选
    "company": "新公司名称",      // 新公司名称，可选
    "bio": "新个人简介",          // 新个人简介，可选
    "avatar_url": "新头像URL",    // 新头像URL，可选
    "is_active": true,            // 是否激活，布尔值，可选
    "is_admin": false             // 是否管理员，布尔值，可选
  }
  ```
- **权限**: 仅管理员
- **响应**: 更新后的用户信息
  ```json
  {
    "id": "uuid字符串",
    "email": "newemail@example.com",
    "name": "新用户名称",
    "company": "新公司名称",
    "bio": "新个人简介",
    "avatar_url": "新头像URL",
    "is_active": true,
    "is_admin": false,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 用户未找到
  - `403 Forbidden`: 权限不足

### 2.7 删除用户
- **路径**: `/users/{user_id}`
- **方法**: `DELETE`
- **路径参数**:
  - `user_id`: 用户ID，UUID字符串
- **权限**: 仅管理员
- **响应**: 删除的用户信息
  ```json
  {
    "id": "uuid字符串",
    "email": "user@example.com",
    "name": "用户名称",
    "company": "公司名称",
    "bio": "个人简介",
    "avatar_url": "头像URL",
    "is_active": true,
    "is_admin": false,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 用户未找到
  - `403 Forbidden`: 权限不足

### 2.8 创建API密钥
- **路径**: `/users/api-keys`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "name": "OpenAI API密钥",     // 密钥名称，必填
    "key": "sk-xxxx",             // API密钥值，必填
    "provider": "openai",         // 提供商，必填，如openai, anthropic等
    "is_active": true             // 是否激活，布尔值，默认true
  }
  ```
- **响应**: 创建的API密钥信息
  ```json
  {
    "id": "uuid字符串",
    "user_id": "用户ID",
    "name": "OpenAI API密钥",
    "key": "sk-xxxx",
    "provider": "openai",
    "is_active": true,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```

### 2.9 获取所有API密钥
- **路径**: `/users/api-keys`
- **方法**: `GET`
- **响应**: 用户的所有API密钥列表
  ```json
  [
    {
      "id": "uuid字符串",
      "user_id": "用户ID",
      "name": "OpenAI API密钥",
      "key": "sk-xxxx",
      "provider": "openai",
      "is_active": true,
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```

### 2.10 更新API密钥
- **路径**: `/users/api-keys/{api_key_id}`
- **方法**: `PUT`
- **路径参数**:
  - `api_key_id`: API密钥ID，UUID字符串
- **请求体**: API密钥更新信息（所有字段均为可选）
  ```json
  {
    "name": "新密钥名称",         // 新密钥名称，可选
    "key": "sk-yyyy",             // 新API密钥值，可选
    "provider": "anthropic",      // 新提供商，可选
    "is_active": false            // 是否激活，布尔值，可选
  }
  ```
- **响应**: 更新后的API密钥信息
  ```json
  {
    "id": "uuid字符串",
    "user_id": "用户ID",
    "name": "新密钥名称",
    "key": "sk-yyyy",
    "provider": "anthropic",
    "is_active": false,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: API密钥未找到
  - `403 Forbidden`: 无权更新此API密钥

### 2.11 删除API密钥
- **路径**: `/users/api-keys/{api_key_id}`
- **方法**: `DELETE`
- **路径参数**:
  - `api_key_id`: API密钥ID，UUID字符串
- **响应**: 操作结果
  ```json
  {
    "detail": "API密钥已删除"
  }
  ```
- **错误响应**:
  - `404 Not Found`: API密钥未找到
  - `403 Forbidden`: 无权删除此API密钥

---

## 3. 数据集 API

### 3.1 创建数据集
- **路径**: `/datasets`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "name": "数据集名称",                   // 数据集名称，必填
    "description": "数据集描述",            // 数据集描述，可选
    "is_public": false,                    // 是否公开，布尔值，默认false
    "tags": ["金融", "客服"],               // 标签，可选
    "metadata": {                          // 元数据，可选
      "source": "内部知识库",
      "version": "1.0"
    }
  }
  ```
- **响应**: 创建的数据集信息
  ```json
  {
    "id": "uuid字符串",
    "user_id": "用户ID",
    "name": "数据集名称",
    "description": "数据集描述",
    "is_public": false,
    "question_count": 0,
    "tags": ["金融", "客服"],
    "metadata": {
      "source": "内部知识库",
      "version": "1.0"
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```

### 3.2 获取数据集列表
- **路径**: `/datasets`
- **方法**: `GET`
- **查询参数**:
  - `skip`: 跳过记录数，整数，默认0
  - `limit`: 返回记录数，整数，默认100
  - `is_public`: 是否只返回公开数据集，布尔值，可选
  - `tags`: 标签过滤，字符串，多个标签用逗号分隔，可选
- **响应**: 数据集列表
  ```json
  [
    {
      "id": "uuid字符串",
      "user_id": "用户ID",
      "name": "数据集名称",
      "description": "数据集描述",
      "is_public": false,
      "question_count": 15,
      "tags": ["金融", "客服"],
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```

### 3.3 获取公开数据集
- **路径**: `/datasets/public`
- **方法**: `GET`
- **查询参数**:
  - `skip`: 跳过记录数，整数，默认0
  - `limit`: 返回记录数，整数，默认100
  - `tags`: 标签过滤，字符串，多个标签用逗号分隔，可选
- **响应**: 公开数据集列表
  ```json
  [
    {
      "id": "uuid字符串",
      "user_id": "用户ID",
      "name": "数据集名称",
      "description": "数据集描述",
      "is_public": true,
      "question_count": 30,
      "tags": ["金融", "客服"],
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```

### 3.4 获取数据集详情
- **路径**: `/datasets/{dataset_id}`
- **方法**: `GET`
- **路径参数**:
  - `dataset_id`: 数据集ID，UUID字符串
- **响应**: 数据集详情
  ```json
  {
    "id": "uuid字符串",
    "user_id": "用户ID",
    "name": "数据集名称",
    "description": "数据集描述",
    "is_public": false,
    "question_count": 15,
    "tags": ["金融", "客服"],
    "metadata": {
      "source": "内部知识库",
      "version": "1.0"
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z",
    "projects": [                          // 使用此数据集的项目列表
      {
        "id": "项目ID1",
        "name": "项目名称1"
      },
      {
        "id": "项目ID2",
        "name": "项目名称2"
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 数据集未找到
  - `403 Forbidden`: 无权限查看此数据集

### 3.5 更新数据集
- **路径**: `/datasets/{dataset_id}`
- **方法**: `PUT`
- **路径参数**:
  - `dataset_id`: 数据集ID，UUID字符串
- **请求体**: 数据集更新信息（所有字段均为可选）
  ```json
  {
    "name": "新数据集名称",               // 新数据集名称，可选
    "description": "新数据集描述",        // 新数据集描述，可选
    "is_public": true,                   // 是否公开，布尔值，可选
    "tags": ["新标签1", "新标签2"],       // 新标签，可选
    "metadata": {                        // 新元数据，可选
      "source": "更新的来源",
      "version": "2.0"
    }
  }
  ```
- **响应**: 更新后的数据集信息
  ```json
  {
    "id": "uuid字符串",
    "user_id": "用户ID",
    "name": "新数据集名称",
    "description": "新数据集描述",
    "is_public": true,
    "question_count": 15,
    "tags": ["新标签1", "新标签2"],
    "metadata": {
      "source": "更新的来源",
      "version": "2.0"
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 数据集未找到
  - `403 Forbidden`: 无权限操作此数据集

### 3.6 删除数据集
- **路径**: `/datasets/{dataset_id}`
- **方法**: `DELETE`
- **路径参数**:
  - `dataset_id`: 数据集ID，UUID字符串
- **响应**: 操作结果
  ```json
  {
    "detail": "数据集已删除"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 数据集未找到
  - `403 Forbidden`: 无权限删除此数据集
  - `400 Bad Request`: 数据集正在被项目使用，无法删除

### 3.7 导入问题到数据集
- **路径**: `/datasets/{dataset_id}/import`
- **方法**: `POST`
- **路径参数**:
  - `dataset_id`: 数据集ID，UUID字符串
- **请求体**:
  ```json
  {
    "questions": [                       // 问题列表，必填
      {
        "question_text": "问题内容1",    // 问题内容，必填
        "standard_answer": "标准答案1",  // 标准答案，必填
        "category": "问题类别1",         // 问题类别，可选
        "difficulty": "难度级别1",       // 难度级别，可选
        "tags": {                        // 标签，可选
          "domain": "金融"
        },
        "metadata": {                    // 元数据，可选
          "source": "用户导入"
        }
      },
      {
        "question_text": "问题内容2",
        "standard_answer": "标准答案2"
      }
    ]
  }
  ```
- **响应**: 导入结果
  ```json
  {
    "success": true,
    "imported_count": 2,
    "failed_count": 0,
    "questions": [
      {
        "id": "问题ID1",
        "question_text": "问题内容1",
        "success": true
      },
      {
        "id": "问题ID2",
        "question_text": "问题内容2",
        "success": true
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 数据集未找到
  - `403 Forbidden`: 无权限操作此数据集

---

## 4. 项目 API

### 4.1 创建项目
- **路径**: `/projects`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "name": "项目名称",                   // 项目名称，必填
    "description": "项目描述",            // 项目描述，可选
    "evaluation_method": "auto",          // 评测方法，可选，默认"auto"，可选值："auto", "manual", "hybrid"
    "scoring_scale": "1-5",               // 评分量表，可选，默认"1-5"，可选值："binary", "1-3", "1-5"
    "status": "created",                  // 项目状态，可选，默认"created"，可选值："created", "in_progress", "completed"
    "dataset_ids": ["数据集ID1", "数据集ID2"], // 关联的数据集ID列表，可选
    "settings": {                         // 项目设置，可选
      "auto_evaluation_model": "gpt-4",
      "default_dimensions": ["accuracy", "relevance"]
    }
  }
  ```
- **响应**: 创建的项目信息
  ```json
  {
    "id": "uuid字符串",
    "user_id": "用户ID",
    "name": "项目名称",
    "description": "项目描述",
    "evaluation_method": "auto",
    "scoring_scale": "1-5",
    "status": "created",
    "settings": {
      "auto_evaluation_model": "gpt-4",
      "default_dimensions": ["accuracy", "relevance"]
    },
    "datasets": [                         // 关联的数据集信息
      {
        "id": "数据集ID1",
        "name": "数据集名称1",
        "question_count": 15
      },
      {
        "id": "数据集ID2",
        "name": "数据集名称2",
        "question_count": 20
      }
    ],
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```

### 4.2 获取用户项目列表
- **路径**: `/projects`
- **方法**: `GET`
- **查询参数**:
  - `skip`: 跳过记录数，整数，默认0
  - `limit`: 返回记录数，整数，默认100
  - `status`: 项目状态过滤，字符串，可选值："created", "in_progress", "completed"
- **响应**: 项目列表
  ```json
  [
    {
      "id": "uuid字符串",
      "user_id": "用户ID",
      "name": "项目名称",
      "description": "项目描述",
      "evaluation_method": "auto",
      "scoring_scale": "1-5",
      "status": "created",
      "settings": {
        "auto_evaluation_model": "gpt-4",
        "default_dimensions": ["accuracy", "relevance"]
      },
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```

### 4.3 获取项目详情
- **路径**: `/projects/{project_id}`
- **方法**: `GET`
- **路径参数**:
  - `project_id`: 项目ID，UUID字符串
- **响应**: 项目详情和评测维度
  ```json
  {
    "id": "uuid字符串",
    "user_id": "用户ID",
    "name": "项目名称",
    "description": "项目描述",
    "evaluation_method": "auto",
    "scoring_scale": "1-5",
    "status": "created",
    "settings": {
      "auto_evaluation_model": "gpt-4",
      "default_dimensions": ["accuracy", "relevance"]
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z",
    "dimensions": [
      {
        "id": "uuid字符串",
        "project_id": "项目ID",
        "name": "accuracy",
        "display_name": "准确性",
        "description": "评估回答与标准答案的事实一致性",
        "weight": 1.0,
        "created_at": "2023-01-01T00:00:00Z"
      },
      {
        "id": "uuid字符串",
        "project_id": "项目ID",
        "name": "relevance",
        "display_name": "相关性",
        "description": "评估回答与问题的匹配度",
        "weight": 1.0,
        "created_at": "2023-01-01T00:00:00Z"
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到

### 4.4 关联数据集到项目
- **路径**: `/projects/{project_id}/datasets`
- **方法**: `POST`
- **路径参数**:
  - `project_id`: 项目ID，UUID字符串
- **请求体**:
  ```json
  {
    "dataset_ids": ["数据集ID1", "数据集ID2"] // 要关联的数据集ID列表，必填
  }
  ```
- **响应**: 操作结果
  ```json
  {
    "success": true,
    "added_datasets": [
      {
        "id": "数据集ID1",
        "name": "数据集名称1"
      },
      {
        "id": "数据集ID2",
        "name": "数据集名称2"
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目或数据集未找到
  - `403 Forbidden`: 无权限操作此项目

### 4.5 从项目移除数据集
- **路径**: `/projects/{project_id}/datasets/{dataset_id}`
- **方法**: `DELETE`
- **路径参数**:
  - `project_id`: 项目ID，UUID字符串
  - `dataset_id`: 数据集ID，UUID字符串
- **响应**: 操作结果
  ```json
  {
    "detail": "数据集已从项目中移除"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目或数据集未找到或数据集未关联到项目
  - `403 Forbidden`: 无权限操作此项目
  - `400 Bad Request`: 项目正在使用此数据集的评测结果，无法移除

### 4.6 更新项目
- **路径**: `/projects/{project_id}`
- **方法**: `PUT`
- **路径参数**:
  - `project_id`: 项目ID，UUID字符串
- **请求体**: 项目更新信息（所有字段均为可选）
  ```json
  {
    "name": "新项目名称",                 // 新项目名称，可选
    "description": "新项目描述",          // 新项目描述，可选
    "evaluation_method": "manual",        // 新评测方法，可选
    "scoring_scale": "1-3",               // 新评分量表，可选
    "status": "in_progress",              // 新项目状态，可选
    "settings": {                         // 新项目设置，可选
      "auto_evaluation_model": "deepseek-r1"
    }
  }
  ```
- **响应**: 更新后的项目信息
  ```json
  {
    "id": "uuid字符串",
    "user_id": "用户ID",
    "name": "新项目名称",
    "description": "新项目描述",
    "evaluation_method": "manual",
    "scoring_scale": "1-3",
    "status": "in_progress",
    "settings": {
      "auto_evaluation_model": "deepseek-r1"
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到
  - `403 Forbidden`: 无权限操作此项目

### 4.7 删除项目
- **路径**: `/projects/{project_id}`
- **方法**: `DELETE`
- **路径参数**:
  - `project_id`: 项目ID，UUID字符串
- **响应**: 操作结果
  ```json
  {
    "detail": "项目已删除"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到
  - `403 Forbidden`: 无权限删除此项目

### 4.8 生成新报告
- **路径**: `/reports/generate`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "project_id": "项目ID",                // 项目ID，必填
    "title": "报告标题",                   // 报告标题，必填
    "report_type": "evaluation",           // 报告类型，必填，可选值："evaluation", "performance", "comparison"
    "config": {                            // 报告配置，可选
      "include_charts": true,
      "include_raw_data": false,
      "dimension_ids": ["维度ID1", "维度ID2"],
      "comparison_systems": ["RAG系统1", "RAG系统2"] // 用于comparison类型
    }
  }
  ```
- **响应**: 生成的报告信息
  ```json
  {
    "id": "报告ID",
    "project_id": "项目ID",
    "user_id": "用户ID",
    "title": "报告标题",
    "description": null,
    "report_type": "evaluation",
    "public": false,
    "config": {
      "include_charts": true,
      "include_raw_data": false,
      "dimension_ids": ["维度ID1", "维度ID2"]
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到
  - `403 Forbidden`: 无权限为此项目生成报告
  - `400 Bad Request`: 参数错误或项目没有足够的评测数据

### 4.9 导出报告
- **路径**: `/reports/export`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "report_id": "报告ID",                 // 报告ID，必填
    "format": "pdf",                       // 导出格式，必填，可选值："pdf", "html", "md", "csv", "xlsx"
    "include_charts": true                 // 是否包含图表，布尔值，默认true
  }
  ```
- **响应**: 导出的报告文件（二进制数据流）
- **响应头**:
  - `Content-Type`: 根据格式不同而不同，如"application/pdf"
  - `Content-Disposition`: `attachment; filename=report_<report_id>.<format>`
- **错误响应**:
  - `404 Not Found`: 报告未找到
  - `403 Forbidden`: 无权限导出此报告
  - `400 Bad Request`: 不支持的导出格式

---

## 5. 问题 API

### 5.1 创建问题
- **路径**: `/questions`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "dataset_id": "数据集ID",              // 数据集ID，必填
    "question_text": "问题内容",           // 问题内容，必填
    "standard_answer": "标准答案",         // 标准答案，必填
    "category": "问题类别",                // 问题类别，可选，如"事实型"，"推理型"等
    "difficulty": "难度级别",              // 难度级别，可选，如"简单"，"中等"，"困难"
    "tags": {                              // 标签，可选
      "domain": "金融",
      "source": "用户反馈"
    },
    "question_metadata": {                 // 元数据，可选
      "source_document": "文档ID",
      "created_by": "用户ID"
    }
  }
  ```
- **响应**: 创建的问题信息
  ```json
  {
    "id": "uuid字符串",
    "dataset_id": "数据集ID",
    "question_text": "问题内容",
    "standard_answer": "标准答案",
    "category": "问题类别",
    "difficulty": "难度级别",
    "tags": {
      "domain": "金融",
      "source": "用户反馈"
    },
    "question_metadata": {
      "source_document": "文档ID",
      "created_by": "用户ID"
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 数据集未找到
  - `403 Forbidden`: 无权限操作此数据集

### 5.2 获取问题列表
- **路径**: `/questions`
- **方法**: `GET`
- **查询参数**:
  - `dataset_id`: 数据集ID，UUID字符串，必填
  - `skip`: 跳过记录数，整数，默认0
  - `limit`: 返回记录数，整数，默认100
  - `category`: 问题类别过滤，字符串，可选
  - `difficulty`: 难度级别过滤，字符串，可选
- **响应**: 问题列表
  ```json
  [
    {
      "id": "uuid字符串",
      "dataset_id": "数据集ID",
      "question_text": "问题内容",
      "standard_answer": "标准答案",
      "category": "问题类别",
      "difficulty": "难度级别",
      "tags": {
        "domain": "金融",
        "source": "用户反馈"
      },
      "question_metadata": {
        "source_document": "文档ID",
        "created_by": "用户ID"
      },
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```
- **错误响应**:
  - `404 Not Found`: 数据集未找到
  - `403 Forbidden`: 无权限查看此数据集

### 5.3 搜索问题
- **路径**: `/questions/search`
- **方法**: `GET`
- **查询参数**:
  - `dataset_id`: 数据集ID，UUID字符串，必填
  - `query`: 搜索关键词，字符串，必填
  - `skip`: 跳过记录数，整数，默认0
  - `limit`: 返回记录数，整数，默认100
- **响应**: 问题列表
  ```json
  [
    {
      "id": "uuid字符串",
      "dataset_id": "数据集ID",
      "question_text": "问题内容",
      "standard_answer": "标准答案",
      "category": "问题类别",
      "difficulty": "难度级别",
      "tags": {
        "domain": "金融",
        "source": "用户反馈"
      },
      "question_metadata": {
        "source_document": "文档ID",
        "created_by": "用户ID"
      },
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```
- **错误响应**:
  - `404 Not Found`: 数据集未找到
  - `403 Forbidden`: 无权限查看此数据集

### 5.4 批量创建问题（续）
- **响应**: 创建的问题列表
  ```json
  [
    {
      "id": "uuid字符串1",
      "dataset_id": "数据集ID",
      "question_text": "问题内容1",
      "standard_answer": "标准答案1",
      "category": "问题类别",
      "difficulty": "难度级别",
      "tags": {
        "domain": "金融"
      },
      "question_metadata": {
        "source": "用户反馈"
      },
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    },
    {
      "id": "uuid字符串2",
      "dataset_id": "数据集ID",
      "question_text": "问题内容2",
      "standard_answer": "标准答案2",
      "category": "问题类别2",
      "difficulty": "难度级别2",
      "tags": null,
      "question_metadata": null,
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```
- **错误响应**:
  - `404 Not Found`: 数据集未找到
  - `403 Forbidden`: 无权限操作此数据集
  - `422 Unprocessable Entity`: 请求数据验证失败

### 5.5 生成问题
- **路径**: `/questions/generate`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "dataset_id": "数据集ID",                // 数据集ID，必填
    "content": "知识库内容",               // 知识库内容，必填，用于生成问题的文本
    "count": 10,                           // 生成问题数量，整数，默认10，范围1-50
    "difficulty": "中等",                  // 难度级别，字符串，默认"中等"，可选值："简单"，"中等"，"困难"
    "question_types": [                    // 问题类型列表，默认["事实型", "推理型", "应用型"]
      "事实型", 
      "推理型", 
      "应用型"
    ],
    "model": "gpt-4",                      // 使用的模型，字符串，默认"gpt-4"
    "model_provider": "openai",            // 模型提供商，字符串，默认"openai"
    "save_to_project": true                // 是否保存到项目，布尔值，默认false
  }
  ```
- **响应**: 生成的问题列表和保存状态
  ```json
  {
    "generated_questions": [
      {
        "question_text": "生成的问题1",
        "standard_answer": "生成的答案1",
        "category": "事实型",
        "difficulty": "中等"
      },
      {
        "question_text": "生成的问题2",
        "standard_answer": "生成的答案2",
        "category": "推理型",
        "difficulty": "中等"
      }
    ],
    "saved_questions": [                   // 如果save_to_project为true，则包含保存的问题信息
      {
        "id": "uuid字符串1",
        "dataset_id": "数据集ID",
        "question_text": "生成的问题1",
        "standard_answer": "生成的答案1",
        "category": "事实型",
        "difficulty": "中等",
        "tags": null,
        "question_metadata": {
          "generated_by": "gpt-4",
          "generation_date": "2023-01-01T00:00:00Z"
        },
        "created_at": "2023-01-01T00:00:00Z",
        "updated_at": "2023-01-01T00:00:00Z"
      }
    ],
    "count": 2                             // 生成的问题数量
  }
  ```
- **错误响应**:
  - `404 Not Found`: 数据集未找到
  - `403 Forbidden`: 无权限操作此数据集
  - `400 Bad Request`: 内容太短或API密钥未配置

### 5.6 获取单个问题详情
- **路径**: `/questions/{question_id}`
- **方法**: `GET`
- **路径参数**:
  - `question_id`: 问题ID，UUID字符串
- **响应**: 问题详情
  ```json
  {
    "id": "uuid字符串",
    "dataset_id": "数据集ID",
    "question_text": "问题内容",
    "standard_answer": "标准答案",
    "category": "问题类别",
    "difficulty": "难度级别",
    "tags": {
      "domain": "金融",
      "source": "用户反馈"
    },
    "question_metadata": {
      "source_document": "文档ID",
      "created_by": "用户ID"
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 问题未找到
  - `403 Forbidden`: 无权限查看此问题

### 5.7 更新问题
- **路径**: `/questions/{question_id}`
- **方法**: `PUT`
- **路径参数**:
  - `question_id`: 问题ID，UUID字符串
- **请求体**: 问题更新信息（所有字段均为可选）
  ```json
  {
    "question_text": "新问题内容",         // 新问题内容，可选
    "standard_answer": "新标准答案",       // 新标准答案，可选
    "category": "新问题类别",              // 新问题类别，可选
    "difficulty": "新难度级别",            // 新难度级别，可选
    "tags": {                              // 新标签，可选
      "domain": "医疗",
      "source": "专家编写"
    },
    "question_metadata": {                 // 新元数据，可选
      "updated_by": "用户ID"
    }
  }
  ```
- **响应**: 更新后的问题信息
  ```json
  {
    "id": "uuid字符串",
    "dataset_id": "数据集ID",
    "question_text": "新问题内容",
    "standard_answer": "新标准答案",
    "category": "新问题类别",
    "difficulty": "新难度级别",
    "tags": {
      "domain": "医疗",
      "source": "专家编写"
    },
    "question_metadata": {
      "updated_by": "用户ID"
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 问题未找到
  - `403 Forbidden`: 无权限操作此问题

### 5.8 删除问题
- **路径**: `/questions/{question_id}`
- **方法**: `DELETE`
- **路径参数**:
  - `question_id`: 问题ID，UUID字符串
- **响应**: 操作结果
  ```json
  {
    "detail": "问题已删除"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 问题未找到
  - `403 Forbidden`: 无权限删除此问题

---

## 6. RAG回答 API

### 6.1 收集RAG回答
- **路径**: `/rag-answers/collect`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "project_id": "项目ID",                // 项目ID，必填
    "question_ids": [                      // 问题ID列表，必填
      "问题ID1", 
      "问题ID2"
    ],
    "api_config": {                        // API配置，必填
      "endpoint_url": "https://api.example.com/rag", // API端点URL，必填
      "api_key": "api_key_value",          // API密钥，可选
      "headers": {                         // 请求头，可选
        "Content-Type": "application/json",
        "Authorization": "Bearer token"
      },
      "request_template": {                // 请求体，必填
        "query": "{question}",
        "max_tokens": 500,
        "temperature": 0.7
      },
      "response_path": "answer",           // 响应路径，默认"answer"，指定从响应中提取答案的JSON路径
      "timeout": 60                        // 超时时间（秒），默认60
    },
    "concurrent_requests": 1,              // 并发请求数，默认1
    "max_attempts": 1,                     // 最大尝试次数，默认1
    "source_system": "RAG系统",            // 来源系统名称，默认"RAG系统"
    "collect_performance": true            // 是否收集性能指标，默认true
  }
  ```
- **响应**: 操作状态和进度信息
  ```json
  {
    "job_id": "uuid字符串",                // 任务ID
    "status": "queued",                    // 任务状态：queued, running, completed, failed
    "total": 2,                            // 总问题数
    "completed": 0,                        // 已完成数
    "failed": 0,                           // 失败数
    "in_progress": 0,                      // 进行中数
    "estimated_completion": "2023-01-01T00:01:00Z" // 预计完成时间
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到
  - `403 Forbidden`: 无权限操作此项目
  - `400 Bad Request`: 请求参数错误

### 6.2 导入RAG回答
- **路径**: `/rag-answers/import`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "project_id": "项目ID",                // 项目ID，必填
    "answers": [                           // 回答列表，必填
      {
        "question_id": "问题ID1",          // 问题ID，必填
        "answer_text": "回答内容1",        // 回答内容，必填
        "metadata": {                      // 元数据，可选
          "source": "手动导入",
          "imported_by": "用户ID"
        }
      },
      {
        "question_id": "问题ID2",
        "answer_text": "回答内容2"
      }
    ],
    "source_system": "手动导入"            // 来源系统名称，默认"手动导入"
  }
  ```
- **响应**: 导入结果统计
  ```json
  {
    "success": true,                       // 操作是否成功
    "total": 2,                            // 总回答数
    "success_count": 2,                    // 成功导入数
    "failed_count": 0,                     // 失败数
    "results": [                           // 详细结果列表
      {
        "question_id": "问题ID1",
        "answer_id": "回答ID1",
        "success": true
      },
      {
        "question_id": "问题ID2",
        "answer_id": "回答ID2",
        "success": true
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到
  - `403 Forbidden`: 无权限操作此项目
  - `400 Bad Request`: 请求参数错误

### 6.3 获取RAG回答列表
- **路径**: `/rag-answers`
- **方法**: `GET`
- **查询参数**:
  - `question_id`: 问题ID，UUID字符串，必填
  - `skip`: 跳过记录数，整数，默认0
  - `limit`: 返回记录数，整数，默认100
- **响应**: RAG回答列表
  ```json
  [
    {
      "id": "uuid字符串",
      "question_id": "问题ID",
      "answer_text": "回答内容",
      "collection_method": "api",          // 收集方式：api, manual
      "source_system": "RAG系统",
      "first_response_time": 120,          // 首次响应时间（毫秒）
      "total_response_time": 350,          // 总响应时间（毫秒）
      "character_count": 500,              // 字符数
      "created_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```
- **错误响应**:
  - `404 Not Found`: 问题未找到
  - `403 Forbidden`: 无权限查看此问题的回答

### 6.4 获取RAG回答详情
- **路径**: `/rag-answers/{answer_id}`
- **方法**: `GET`
- **路径参数**:
  - `answer_id`: 回答ID，UUID字符串
- **响应**: RAG回答详情
  ```json
  {
    "id": "uuid字符串",
    "question_id": "问题ID",
    "answer_text": "回答内容",
    "collection_method": "api",
    "source_system": "RAG系统",
    "first_response_time": 120,
    "total_response_time": 350,
    "character_count": 500,
    "characters_per_second": 1.43,         // 生成速度（字符/秒）
    "raw_response": {                      // 原始API响应
      "answer": "回答内容",
      "metadata": {
        "sources": ["doc1", "doc2"]
      }
    },
    "answer_metadata": {                   // 回答元数据
      "collected_by": "用户ID",
      "api_version": "v1"
    },
    "created_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 回答未找到
  - `403 Forbidden`: 无权限查看此回答

### 6.5 更新RAG回答
- **路径**: `/rag-answers/{answer_id}`
- **方法**: `PUT`
- **路径参数**:
  - `answer_id`: 回答ID，UUID字符串
- **请求体**: RAG回答更新信息（所有字段均为可选）
  ```json
  {
    "answer_text": "新回答内容",           // 新回答内容，可选
    "source_system": "新来源系统",         // 新来源系统，可选
    "answer_metadata": {                   // 新元数据，可选
      "updated_by": "用户ID",
      "update_reason": "修正错误"
    }
  }
  ```
- **响应**: 更新后的RAG回答
  ```json
  {
    "id": "uuid字符串",
    "question_id": "问题ID",
    "answer_text": "新回答内容",
    "collection_method": "manual",         // 更新后自动变为manual
    "source_system": "新来源系统",
    "first_response_time": 120,
    "total_response_time": 350,
    "character_count": 500,                // 会根据新内容更新
    "answer_metadata": {
      "updated_by": "用户ID",
      "update_reason": "修正错误"
    },
    "created_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 回答未找到
  - `403 Forbidden`: 无权限更新此回答

### 6.6 删除RAG回答
- **路径**: `/rag-answers/{answer_id}`
- **方法**: `DELETE`
- **路径参数**:
  - `answer_id`: 回答ID，UUID字符串
- **响应**: 操作结果
  ```json
  {
    "detail": "回答已删除"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 回答未找到
  - `403 Forbidden`: 无权限删除此回答

---

## 7. 评测 API

### 7.1 获取项目评测摘要
- **路径**: `/evaluations/project/{project_id}/summary`
- **方法**: `GET`
- **路径参数**:
  - `project_id`: 项目ID，UUID字符串
- **响应**: 项目评测摘要
  ```json
  {
    "project_id": "项目ID",
    "project_name": "项目名称",
    "total_score": 4.2,                    // 总评分
    "dimension_scores": [                  // 各维度评分
      {
        "dimension_id": "维度ID1",
        "dimension_name": "准确性",
        "score": 4.5,                      // 维度平均分
        "count": 10,                       // 评测数量
        "weight": 1.0                      // 维度权重
      },
      {
        "dimension_id": "维度ID2",
        "dimension_name": "相关性",
        "score": 3.8,
        "count": 10,
        "weight": 1.0
      }
    ],
    "question_count": 20,                  // 问题总数
    "evaluated_count": 10,                 // 已评测问题数
    "evaluation_progress": 0.5             // 评测进度（0-1）
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到
  - `403 Forbidden`: 无权限查看此项目的评测摘要

### 7.2 获取项目评测详情
- **路径**: `/evaluations/project/{project_id}/details`
- **方法**: `GET`
- **路径参数**:
  - `project_id`: 项目ID，UUID字符串
- **查询参数**:
  - `dimension_id`: 维度ID，UUID字符串，可选，用于过滤特定维度的评测结果
- **响应**: 项目评测详情
  ```json
  {
    "project_id": "项目ID",
    "project_name": "项目名称",
    "dimensions": [                        // 项目维度列表
      {
        "id": "维度ID1",
        "name": "准确性",
        "display_name": "准确性",
        "description": "评估回答与标准答案的事实一致性",
        "weight": 1.0
      }
    ],
    "questions": [                         // 问题评测结果列表
      {
        "question_id": "问题ID1",
        "question_text": "问题内容1",
        "standard_answer": "标准答案1",
        "category": "问题类别1",
        "difficulty": "难度级别1",
        "answers": [                       // 该问题的回答评测结果
          {
            "answer_id": "回答ID1",
            "source_system": "RAG系统1",
            "dimension_scores": {          // 各维度评分
              "维度ID1": {
                "score": 4.5,
                "explanation": "评测解释",
                "evaluation_method": "auto",
                "evaluator_id": null,
                "model_name": "gpt-4",
                "created_at": "2023-01-01T00:00:00Z"
              }
            },
            "average_score": 4.5           // 该回答的平均分
          }
        ]
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到
  - `403 Forbidden`: 无权限查看此项目的评测结果

### 7.3 获取回答评测结果
- **路径**: `/evaluations/answer/{rag_answer_id}`
- **方法**: `GET`
- **路径参数**:
  - `rag_answer_id`: 回答ID，UUID字符串
- **响应**: 回答评测结果
  ```json
  {
    "answer_id": "回答ID",
    "question_id": "问题ID",
    "question_text": "问题内容",
    "standard_answer": "标准答案",
    "answer_text": "回答内容",
    "source_system": "RAG系统",
    "evaluations": [                       // 各维度评测结果
      {
        "id": "评测ID1",
        "dimension_id": "维度ID1",
        "dimension_name": "准确性",
        "score": 4.5,
        "evaluation_method": "auto",
        "evaluator_id": null,
        "model_name": "gpt-4",
        "explanation": "评测解释",
        "created_at": "2023-01-01T00:00:00Z"
      },
      {
        "id": "评测ID2",
        "dimension_id": "维度ID2",
        "dimension_name": "相关性",
        "score": 3.8,
        "evaluation_method": "manual",
        "evaluator_id": "用户ID",
        "model_name": null,
        "explanation": "人工评测解释",
        "created_at": "2023-01-01T00:00:00Z"
      }
    ],
    "average_score": 4.15                  // 平均分
  }
  ```
- **错误响应**:
  - `404 Not Found`: 回答未找到
  - `403 Forbidden`: 无权限查看此回答的评测结果

### 7.4 获取问题评测结果
- **路径**: `/evaluations/question/{question_id}`
- **方法**: `GET`
- **路径参数**:
  - `question_id`: 问题ID，UUID字符串
- **响应**: 问题评测结果
  ```json
  {
    "question_id": "问题ID",
    "question_text": "问题内容",
    "standard_answer": "标准答案",
    "category": "问题类别",
    "difficulty": "难度级别",
    "answers": [                           // 该问题的所有回答评测结果
      {
        "answer_id": "回答ID1",
        "answer_text": "回答内容1",
        "source_system": "RAG系统1",
        "collection_method": "api",
        "created_at": "2023-01-01T00:00:00Z",
        "evaluations": [                   // 各维度评测结果
          {
            "dimension_id": "维度ID1",
            "dimension_name": "准确性",
            "score": 4.5,
            "evaluation_method": "auto",
            "created_at": "2023-01-01T00:00:00Z"
          }
        ],
        "average_score": 4.5               // 该回答的平均分
      },
      {
        "answer_id": "回答ID2",
        "answer_text": "回答内容2",
        "source_system": "RAG系统2",
        "collection_method": "api",
        "created_at": "2023-01-01T00:00:00Z",
        "evaluations": [
          {
            "dimension_id": "维度ID1",
            "dimension_name": "准确性",
            "score": 3.5,
            "evaluation_method": "auto",
            "created_at": "2023-01-01T00:00:00Z"
          }
        ],
        "average_score": 3.5
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 问题未找到
  - `403 Forbidden`: 无权限查看此问题的评测结果

### 7.5 比较问题的不同回答
- **路径**: `/evaluations/compare/{question_id}`
- **方法**: `GET`
- **路径参数**:
  - `question_id`: 问题ID，UUID字符串
- **响应**: 问题不同回答的评测比较
  ```json
  {
    "question": {                          // 问题信息
      "id": "问题ID",
      "question_text": "问题内容",
      "standard_answer": "标准答案"
    },
    "dimensions": [                        // 评测维度列表
      {
        "id": "维度ID1",
        "name": "准确性",
        "weight": 1.0
      },
      {
        "id": "维度ID2",
        "name": "相关性",
        "weight": 1.0
      }
    ],
    "comparisons": [                       // 回答比较列表
      {
        "answer_id": "回答ID1",
        "source_system": "RAG系统1",
        "answer_text": "回答内容1",
        "scores": {                        // 各维度评分
          "维度ID1": 4.5,
          "维度ID2": 4.0
        },
        "average_score": 4.25,             // 平均分
        "performance": {                   // 性能指标
          "response_time": 350,            // 响应时间（毫秒）
          "character_count": 500           // 字符数
        }
      },
      {
        "answer_id": "回答ID2",
        "source_system": "RAG系统2",
        "answer_text": "回答内容2",
        "scores": {
          "维度ID1": 3.5,
          "维度ID2": 3.0
        },
        "average_score": 3.25,
        "performance": {
          "response_time": 250,
          "character_count": 400
        }
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 问题未找到
  - `403 Forbidden`: 无权限查看此问题的评测结果

---

## 8. 自动评测 API

### 8.1 单个回答自动评测
- **路径**: `/auto-evaluation/single`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "question_id": "问题ID",               // 问题ID，必填
    "question_text": "问题内容",           // 问题内容，必填
    "standard_answer": "标准答案",         // 标准答案，必填
    "rag_answer_id": "回答ID",             // 回答ID，必填
    "rag_answer_text": "回答内容",         // 回答内容，必填
    "dimension_id": "维度ID",              // 维度ID，必填
    "dimension_name": "维度名称",          // 维度名称，必填
    "dimension_description": "维度描述",   // 维度描述，可选
    "model": "gpt-4"                       // 评测模型，可选，默认"gpt-4"
  }
  ```
- **响应**: 评测结果
  ```json
  {
    "evaluation_id": "评测ID",             // 评测ID
    "question_id": "问题ID",
    "rag_answer_id": "回答ID",
    "dimension_id": "维度ID",
    "score": 4.5,                          // 评分
    "explanation": "评测解释",             // 评测解释
    "evaluation_method": "auto",
    "model_name": "gpt-4",
    "created_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 问题或回答未找到
  - `403 Forbidden`: 无权限评测此问题
  - `400 Bad Request`: API密钥未配置或评测失败

### 8.2 批量自动评测
- **路径**: `/auto-evaluation/batch`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "project_id": "项目ID",                // 项目ID，必填
    "model": "gpt-4",                      // 评测模型，可选，默认"gpt-4"
    "dimensions": ["维度ID1", "维度ID2"],  // 维度ID列表，可选，不填则评测所有维度
    "evaluation_type": "auto",             // 评测类型，可选，默认"auto"
    "question_ids": ["问题ID1", "问题ID2"], // 问题ID列表，可选，不填则评测所有问题
    "include_evaluated": false             // 是否包含已评测的问题，布尔值，默认false
  }
  ```
- **响应**: 批量评测任务信息
  ```json
  {
    "task_id": "任务ID",                   // 批量评测任务ID
    "project_id": "项目ID",
    "status": "running",                   // 任务状态：queued, running, completed, failed
    "total_evaluations": 10,               // 总评测数
    "completed_evaluations": 0,            // 已完成评测数
    "failed_evaluations": 0,               // 失败评测数
    "start_time": "2023-01-01T00:00:00Z",  // 开始时间
    "estimated_completion": "2023-01-01T00:05:00Z" // 预计完成时间
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到
  - `403 Forbidden`: 无权限评测此项目
  - `400 Bad Request`: API密钥未配置或参数错误

### 8.3 获取批量评测任务状态
- **路径**: `/auto-evaluation/status/{task_id}`
- **方法**: `GET`
- **路径参数**:
  - `task_id`: 任务ID，UUID字符串
- **响应**: 批量评测任务状态
  ```json
  {
    "task_id": "任务ID",
    "project_id": "项目ID",
    "status": "completed",                 // 任务状态
    "total_evaluations": 10,
    "completed_evaluations": 10,
    "failed_evaluations": 0,
    "start_time": "2023-01-01T00:00:00Z",
    "end_time": "2023-01-01T00:05:00Z",    // 结束时间
    "duration": 300,                       // 持续时间（秒）
    "results": [                           // 评测结果列表（仅在completed状态下返回）
      {
        "question_id": "问题ID1",
        "rag_answer_id": "回答ID1",
        "dimension_id": "维度ID1",
        "score": 4.5,
        "evaluation_id": "评测ID1"
      }
    ],
    "errors": [                            // 错误列表（如有）
      {
        "question_id": "问题ID2",
        "rag_answer_id": "回答ID2",
        "dimension_id": "维度ID1",
        "error": "评测失败原因"
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 任务未找到
  - `403 Forbidden`: 无权限查看此任务

---

## 9. 人工评测 API

### 9.1 创建人工评测
- **路径**: `/manual-evaluation`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "question_id": "问题ID",               // 问题ID，必填
    "rag_answer_id": "回答ID",             // 回答ID，必填
    "dimension_id": "维度ID",              // 维度ID，必填
    "score": 4.5,                          // 评分，必填，根据项目评分量表范围
    "explanation": "评测解释",             // 评测解释，可选
    "evaluation_method": "manual"          // 评测方法，必填，固定为"manual"
  }
  ```
- **响应**: 创建的评测结果
  ```json
  {
    "id": "评测ID",
    "question_id": "问题ID",
    "rag_answer_id": "回答ID",
    "dimension_id": "维度ID",
    "score": 4.5,
    "explanation": "评测解释",
    "evaluation_method": "manual",
    "evaluator_id": "评测人ID",            // 当前用户ID
    "model_name": null,
    "created_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 问题或回答或维度未找到
  - `403 Forbidden`: 无权限评测此问题
  - `400 Bad Request`: 评分超出范围或参数错误

### 9.2 获取人工评测列表
- **路径**: `/manual-evaluation`
- **方法**: `GET`
- **查询参数**:
  - `question_id`: 问题ID，UUID字符串，可选
  - `rag_answer_id`: 回答ID，UUID字符串，可选
  - `evaluator_id`: 评测人ID，UUID字符串，可选
  - `skip`: 跳过记录数，整数，默认0
  - `limit`: 返回记录数，整数，默认100
- **响应**: 人工评测列表
  ```json
  [
    {
      "id": "评测ID",
      "question_id": "问题ID",
      "rag_answer_id": "回答ID",
      "dimension_id": "维度ID",
      "dimension_name": "维度名称",
      "score": 4.5,
      "explanation": "评测解释",
      "evaluation_method": "manual",
      "evaluator_id": "评测人ID",
      "evaluator_name": "评测人姓名",
      "created_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```

### 9.3 获取人工评测详情
- **路径**: `/manual-evaluation/{evaluation_id}`
- **方法**: `GET`
- **路径参数**:
  - `evaluation_id`: 评测ID，UUID字符串
- **响应**: 评测详情
  ```json
  {
    "id": "评测ID",
    "question_id": "问题ID",
    "question_text": "问题内容",
    "standard_answer": "标准答案",
    "rag_answer_id": "回答ID",
    "answer_text": "回答内容",
    "dimension_id": "维度ID",
    "dimension_name": "维度名称",
    "dimension_description": "维度描述",
    "score": 4.5,
    "explanation": "评测解释",
    "evaluation_method": "manual",
    "evaluator_id": "评测人ID",
    "evaluator_name": "评测人姓名",
    "created_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 评测未找到
  - `403 Forbidden`: 无权限查看此评测

### 9.4 更新人工评测
- **路径**: `/manual-evaluation/{evaluation_id}`
- **方法**: `PUT`
- **路径参数**:
  - `evaluation_id`: 评测ID，UUID字符串
- **请求体**: 评测更新信息（所有字段均为可选）
  ```json
  {
    "score": 4.0,                          // 新评分，可选
    "explanation": "新评测解释"            // 新评测解释，可选
  }
  ```
- **响应**: 更新后的评测信息
  ```json
  {
    "id": "评测ID",
    "question_id": "问题ID",
    "rag_answer_id": "回答ID",
    "dimension_id": "维度ID",
    "score": 4.0,
    "explanation": "新评测解释",
    "evaluation_method": "manual",
    "evaluator_id": "评测人ID",
    "model_name": null,
    "created_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 评测未找到
  - `403 Forbidden`: 无权限更新此评测（只能更新自己创建的评测）
  - `400 Bad Request`: 评分超出范围

### 9.5 删除人工评测
- **路径**: `/manual-evaluation/{evaluation_id}`
- **方法**: `DELETE`
- **路径参数**:
  - `evaluation_id`: 评测ID，UUID字符串
- **响应**: 操作结果
  ```json
  {
    "detail": "评测已删除"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 评测未找到
  - `403 Forbidden`: 无权限删除此评测（只能删除自己创建的评测）

---

## 10. 报告 API

### 10.1 创建报告
- **路径**: `/reports`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "project_id": "项目ID",                // 项目ID，必填
    "title": "报告标题",                   // 报告标题，必填
    "description": "报告描述",             // 报告描述，可选
    "report_type": "evaluation",           // 报告类型，必填，可选值："evaluation", "performance", "comparison"
    "public": false,                       // 是否公开，布尔值，默认false
    "config": {                            // 报告配置，可选
      "include_charts": true,
      "include_raw_data": false,
      "dimension_ids": ["维度ID1", "维度ID2"]
    }
  }
  ```
- **响应**: 创建的报告信息
  ```json
  {
    "id": "报告ID",
    "project_id": "项目ID",
    "user_id": "用户ID",
    "title": "报告标题",
    "description": "报告描述",
    "report_type": "evaluation",
    "public": false,
    "config": {
      "include_charts": true,
      "include_raw_data": false,
      "dimension_ids": ["维度ID1", "维度ID2"]
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到
  - `403 Forbidden`: 无权限为此项目创建报告
  - `400 Bad Request`: 参数错误

### 10.2 获取用户报告列表
- **路径**: `/reports`
- **方法**: `GET`
- **查询参数**:
  - `project_id`: 项目ID，UUID字符串，可选
  - `report_type`: 报告类型，字符串，可选
  - `skip`: 跳过记录数，整数，默认0
  - `limit`: 返回记录数，整数，默认100
- **响应**: 报告列表
  ```json
  [
    {
      "id": "报告ID",
      "project_id": "项目ID",
      "project_name": "项目名称",
      "user_id": "用户ID",
      "title": "报告标题",
      "description": "报告描述",
      "report_type": "evaluation",
      "public": false,
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```

### 10.3 获取报告详情
- **路径**: `/reports/{report_id}`
- **方法**: `GET`
- **路径参数**:
  - `report_id`: 报告ID，UUID字符串
- **响应**: 报告详情
  ```json
  {
    "id": "报告ID",
    "project_id": "项目ID",
    "project_name": "项目名称",
    "user_id": "用户ID",
    "title": "报告标题",
    "description": "报告描述",
    "report_type": "evaluation",
    "public": false,
    "config": {
      "include_charts": true,
      "include_raw_data": false,
      "dimension_ids": ["维度ID1", "维度ID2"]
    },
    "content": {                           // 报告内容
      "summary": {                         // 摘要
        "total_score": 4.2,
        "dimension_scores": [
          {
            "dimension_id": "维度ID1",
            "dimension_name": "准确性",
            "score": 4.5,
            "count": 10
          }
        ],
        "question_count": 20,
        "evaluated_count": 10
      },
      "charts": [                          // 图表数据
        {
          "chart_type": "bar",
          "title": "维度评分分布",
          "data": {
            "labels": ["准确性", "相关性", "完整性"],
            "datasets": [
              {
                "label": "平均分",
                "data": [4.5, 4.0, 3.8]
              }
            ]
          }
        }
      ],
      "details": [                         // 详细数据
        {
          "question_id": "问题ID1",
          "question_text": "问题内容1",
          "answers": [
            {
              "answer_id": "回答ID1",
              "source_system": "RAG系统1",
              "scores": {
                "准确性": 4.5,
                "相关性": 4.0
              }
            }
          ]
        }
      ]
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 报告未找到
  - `403 Forbidden`: 无权限查看此报告

### 10.4 更新报告
- **路径**: `/reports/{report_id}`
- **方法**: `PUT`
- **路径参数**:
  - `report_id`: 报告ID，UUID字符串
- **请求体**: 报告更新信息（所有字段均为可选）
  ```json
  {
    "title": "新报告标题",                 // 新报告标题，可选
    "description": "新报告描述",           // 新报告描述，可选
    "public": true,                        // 是否公开，布尔值，可选
    "config": {                            // 新报告配置，可选
      "include_charts": false,
      "include_raw_data": true
    }
  }
  ```
- **响应**: 更新后的报告信息
  ```json
  {
    "id": "报告ID",
    "project_id": "项目ID",
    "user_id": "用户ID",
    "title": "新报告标题",
    "description": "新报告描述",
    "report_type": "evaluation",
    "public": true,
    "config": {
      "include_charts": false,
      "include_raw_data": true,
      "dimension_ids": ["维度ID1", "维度ID2"]
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 报告未找到
  - `403 Forbidden`: 无权限更新此报告

### 10.5 删除报告
- **路径**: `/reports/{report_id}`
- **方法**: `DELETE`
- **路径参数**:
  - `report_id`: 报告ID，UUID字符串
- **响应**: 操作结果
  ```json
  {
    "detail": "报告已删除"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 报告未找到
  - `403 Forbidden`: 无权限删除此报告

### 10.6 生成新报告
- **路径**: `/reports/generate`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "project_id": "项目ID",                // 项目ID，必填
    "title": "报告标题",                   // 报告标题，必填
    "report_type": "evaluation",           // 报告类型，必填，可选值："evaluation", "performance", "comparison"
    "config": {                            // 报告配置，可选
      "include_charts": true,
      "include_raw_data": false,
      "dimension_ids": ["维度ID1", "维度ID2"],
      "comparison_systems": ["RAG系统1", "RAG系统2"] // 用于comparison类型
    }
  }
  ```
- **响应**: 生成的报告信息
  ```json
  {
    "id": "报告ID",
    "project_id": "项目ID",
    "user_id": "用户ID",
    "title": "报告标题",
    "description": null,
    "report_type": "evaluation",
    "public": false,
    "config": {
      "include_charts": true,
      "include_raw_data": false,
      "dimension_ids": ["维度ID1", "维度ID2"]
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到
  - `403 Forbidden`: 无权限为此项目生成报告
  - `400 Bad Request`: 参数错误或项目没有足够的评测数据

### 10.7 导出报告
- **路径**: `/reports/export`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "report_id": "报告ID",                 // 报告ID，必填
    "format": "pdf",                       // 导出格式，必填，可选值："pdf", "html", "md", "csv", "xlsx"
    "include_charts": true                 // 是否包含图表，布尔值，默认true
  }
  ```
- **响应**: 导出的报告文件（二进制数据流）
- **响应头**:
  - `Content-Type`: 根据格式不同而不同，如"application/pdf"
  - `Content-Disposition`: `attachment; filename=report_<report_id>.<format>`
- **错误响应**:
  - `404 Not Found`: 报告未找到
  - `403 Forbidden`: 无权限导出此报告
  - `400 Bad Request`: 不支持的导出格式

---

## 11. 性能测试 API

### 11.1 创建性能测试
- **路径**: `/performance`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "project_id": "项目ID",                // 项目ID，必填
    "name": "测试名称",                    // 测试名称，必填
    "description": "测试描述",             // 测试描述，可选
    "test_type": "latency",                // 测试类型，必填，可选值："latency", "throughput", "concurrency"
    "config": {                            // 测试配置，可选
      "max_concurrency": 10,
      "duration": 60,
      "ramp_up": 10
    }
  }
  ```
- **响应**: 创建的性能测试信息
  ```json
  {
    "id": "测试ID",
    "project_id": "项目ID",
    "user_id": "用户ID",
    "name": "测试名称",
    "description": "测试描述",
    "test_type": "latency",
    "config": {
      "max_concurrency": 10,
      "duration": 60,
      "ramp_up": 10
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目未找到
  - `403 Forbidden`: 无权限为此项目创建性能测试
  - `400 Bad Request`: 参数错误

### 11.2 获取性能测试列表
- **路径**: `/performance`
- **方法**: `GET`
- **查询参数**:
  - `project_id`: 项目ID，UUID字符串，可选
  - `skip`: 跳过记录数，整数，默认0
  - `limit`: 返回记录数，整数，默认100
- **响应**: 性能测试列表
  ```json
  [
    {
      "id": "测试ID",
      "project_id": "项目ID",
      "project_name": "项目名称",
      "user_id": "用户ID",
      "name": "测试名称",
      "description": "测试描述",
      "test_type": "latency",
      "status": "completed",               // 测试状态
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    }
  ]
  ```

### 11.3 获取性能测试详情
- **路径**: `/performance/{test_id}`
- **方法**: `GET`
- **路径参数**:
  - `test_id`: 测试ID，UUID字符串
- **响应**: 性能测试详情
  ```json
  {
    "id": "测试ID",
    "project_id": "项目ID",
    "project_name": "项目名称",
    "user_id": "用户ID",
    "name": "测试名称",
    "description": "测试描述",
    "test_type": "latency",
    "status": "completed",
    "config": {
      "max_concurrency": 10,
      "duration": 60,
      "ramp_up": 10,
      "api_config_id": "API配置ID",
      "question_ids": ["问题ID1", "问题ID2"]
    },
    "summary": {                           // 测试结果摘要
      "start_time": "2023-01-01T00:00:00Z",
      "end_time": "2023-01-01T00:01:00Z",
      "duration": 60,
      "total_requests": 100,
      "successful_requests": 95,
      "failed_requests": 5,
      "avg_response_time": 250,            // 平均响应时间（毫秒）
      "min_response_time": 150,            // 最小响应时间（毫秒）
      "max_response_time": 500,            // 最大响应时间（毫秒）
      "p50_response_time": 230,            // 50%响应时间（毫秒）
      "p90_response_time": 350,            // 90%响应时间（毫秒）
      "p95_response_time": 400,            // 95%响应时间（毫秒）
      "p99_response_time": 480,            // 99%响应时间（毫秒）
      "throughput": 1.67,                  // 吞吐量（每秒请求数）
      "error_rate": 0.05                   // 错误率
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:01:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 测试未找到
  - `403 Forbidden`: 无权限查看此测试

### 11.4 更新性能测试
- **路径**: `/performance/{test_id}`
- **方法**: `PUT`
- **路径参数**:
  - `test_id`: 测试ID，UUID字符串
- **请求体**: 性能测试更新信息（所有字段均为可选）
  ```json
  {
    "name": "新测试名称",                  // 新测试名称，可选
    "description": "新测试描述",           // 新测试描述，可选
    "config": {                            // 新测试配置，可选
      "max_concurrency": 20,
      "duration": 120
    }
  }
  ```
- **响应**: 更新后的性能测试信息
  ```json
  {
    "id": "测试ID",
    "project_id": "项目ID",
    "user_id": "用户ID",
    "name": "新测试名称",
    "description": "新测试描述",
    "test_type": "latency",
    "config": {
      "max_concurrency": 20,
      "duration": 120,
      "ramp_up": 10
    },
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 测试未找到
  - `403 Forbidden`: 无权限更新此测试
  - `400 Bad Request`: 已运行的测试不能更新配置

### 11.5 删除性能测试
- **路径**: `/performance/{test_id}`
- **方法**: `DELETE`
- **路径参数**:
  - `test_id`: 测试ID，UUID字符串
- **响应**: 操作结果
  ```json
  {
    "detail": "性能测试已删除"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 测试未找到
  - `403 Forbidden`: 无权限删除此测试

### 11.6 运行性能测试
- **路径**: `/performance/run`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "project_id": "项目ID",                // 项目ID，必填
    "name": "测试名称",                    // 测试名称，必填
    "description": "测试描述",             // 测试描述，可选
    "api_config_id": "API配置ID",          // API配置ID，必填
    "concurrency": 5,                      // 并发数，整数，默认1，范围1-50
    "duration": 60,                        // 测试持续时间（秒），整数，默认60，范围1-300
    "ramp_up": 10,                         // 逐步增加负载的时间（秒），整数，默认0，范围0-60
    "requests_per_second": 10,             // 每秒请求数限制，整数，可选，不填表示不限制
    "question_ids": ["问题ID1", "问题ID2"] // 要测试的问题ID列表，可选，不填表示使用项目中的所有问题
  }
  ```
- **响应**: 测试运行状态
  ```json
  {
    "test_id": "测试ID",
    "status": "running",
    "start_time": "2023-01-01T00:00:00Z",
    "estimated_completion": "2023-01-01T00:01:00Z"
  }
  ```
- **错误响应**:
  - `404 Not Found`: 项目或API配置未找到
  - `403 Forbidden`: 无权限运行此测试
  - `400 Bad Request`: 参数错误或项目没有问题

### 11.7 获取测试状态
- **路径**: `/performance/status/{task_id}`
- **方法**: `GET`
- **路径参数**:
  - `task_id`: 任务ID，UUID字符串
- **响应**: 测试运行状态
  ```json
  {
    "task_id": "任务ID",
    "test_id": "测试ID",
    "status": "running",                   // 任务状态：queued, running, completed, failed
    "progress": 0.45,                      // 进度（0-1）
    "start_time": "2023-01-01T00:00:00Z",
    "current_time": "2023-01-01T00:00:30Z",
    "estimated_completion": "2023-01-01T00:01:00Z",
    "metrics": {                           // 实时指标（仅在running状态下返回）
      "requests_completed": 45,
      "requests_failed": 2,
      "current_rps": 1.5,                  // 当前每秒请求数
      "avg_response_time": 230             // 当前平均响应时间（毫秒）
    }
  }
  ```
- **错误响应**:
  - `404 Not Found`: 任务未找到

### 11.8 获取测试结果
- **路径**: `/performance/results/{test_id}`
- **方法**: `GET`
- **路径参数**:
  - `test_id`: 测试ID，UUID字符串
- **响应**: 测试结果详情
  ```json
  {
    "test_id": "测试ID",
    "project_id": "项目ID",
    "name": "测试名称",
    "status": "completed",
    "summary": {                           // 测试结果摘要
      "start_time": "2023-01-01T00:00:00Z",
      "end_time": "2023-01-01T00:01:00Z",
      "duration": 60,
      "total_requests": 100,
      "successful_requests": 95,
      "failed_requests": 5,
      "avg_response_time": 250,            // 平均响应时间（毫秒）
      "min_response_time": 150,            // 最小响应时间（毫秒）
      "max_response_time": 500,            // 最大响应时间（毫秒）
      "p50_response_time": 230,            // 50%响应时间（毫秒）
      "p90_response_time": 350,            // 90%响应时间（毫秒）
      "p95_response_time": 400,            // 95%响应时间（毫秒）
      "p99_response_time": 480,            // 99%响应时间（毫秒）
      "throughput": 1.67,                  // 吞吐量（每秒请求数）
      "error_rate": 0.05                   // 错误率
    },
    "time_series": [                       // 时间序列数据
      {
        "timestamp": "2023-01-01T00:00:10Z",
        "active_users": 5,                 // 活跃用户数
        "requests_per_second": 1.5,        // 每秒请求数
        "avg_response_time": 240,          // 平均响应时间（毫秒）
        "error_count": 0                   // 错误数
      },
      {
        "timestamp": "2023-01-01T00:00:20Z",
        "active_users": 5,
        "requests_per_second": 1.7,
        "avg_response_time": 250,
        "error_count": 1
      }
    ],
    "errors": [                            // 错误详情
      {
        "timestamp": "2023-01-01T00:00:25Z",
        "question_id": "问题ID1",
        "error_type": "timeout",
        "error_message": "请求超时"
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 测试未找到
  - `403 Forbidden`: 无权限查看此测试结果
  - `400 Bad Request`: 测试尚未完成

### 11.9 获取测试指标
- **路径**: `/performance/metrics/{test_id}`
- **方法**: `GET`
- **路径参数**:
  - `test_id`: 测试ID，UUID字符串
- **查询参数**:
  - `metric_type`: 指标类型，字符串，可选，可选值："response_time", "throughput", "error_rate"
- **响应**: 测试指标数据
  ```json
  {
    "test_id": "测试ID",
    "metrics": [
      {
        "metric_type": "response_time",
        "unit": "ms",
        "data": [
          {
            "timestamp": "2023-01-01T00:00:10Z",
            "value": 240
          },
          {
            "timestamp": "2023-01-01T00:00:20Z",
            "value": 250
          }
        ],
        "statistics": {
          "min": 150,
          "max": 500,
          "avg": 250,
          "p50": 230,
          "p90": 350,
          "p95": 400,
          "p99": 480
        }
      },
      {
        "metric_type": "throughput",
        "unit": "req/s",
        "data": [
          {
            "timestamp": "2023-01-01T00:00:10Z",
            "value": 1.5
          },
          {
            "timestamp": "2023-01-01T00:00:20Z",
            "value": 1.7
          }
        ],
        "statistics": {
          "min": 1.2,
          "max": 2.1,
          "avg": 1.67
        }
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 测试未找到
  - `403 Forbidden`: 无权限查看此测试指标

### 11.10 比较性能测试
- **路径**: `/performance/compare`
- **方法**: `POST`
- **请求体**:
  ```json
  {
    "test_ids": ["测试ID1", "测试ID2"],    // 要比较的测试ID列表，必填
    "metrics": ["response_time", "throughput", "error_rate"] // 要比较的指标，可选，默认全部
  }
  ```
- **响应**: 测试比较结果
  ```json
  {
    "tests": [                             // 测试基本信息
      {
        "id": "测试ID1",
        "name": "测试名称1",
        "description": "测试描述1",
        "test_type": "latency",
        "created_at": "2023-01-01T00:00:00Z"
      },
      {
        "id": "测试ID2",
        "name": "测试名称2",
        "description": "测试描述2",
        "test_type": "latency",
        "created_at": "2023-01-02T00:00:00Z"
      }
    ],
    "comparison": {                        // 比较结果
      "response_time": {                   // 响应时间比较
        "unit": "ms",
        "values": [250, 220],              // 对应tests中的测试
        "diff": 30,                        // 差值
        "diff_percentage": 13.64,          // 差值百分比
        "better": 1                        // 哪个测试更好（索引）
      },
      "throughput": {                      // 吞吐量比较
        "unit": "req/s",
        "values": [1.67, 1.82],
        "diff": 0.15,
        "diff_percentage": 8.98,
        "better": 1
      },
      "error_rate": {                      // 错误率比较
        "unit": "%",
        "values": [5.0, 3.0],
        "diff": 2.0,
        "diff_percentage": 66.67,
        "better": 1
      }
    },
    "charts": [                            // 图表数据
      {
        "metric": "response_time",
        "chart_type": "bar",
        "data": {
          "labels": ["测试名称1", "测试名称2"],
          "datasets": [
            {
              "label": "平均响应时间 (ms)",
              "data": [250, 220]
            }
          ]
        }
      }
    ]
  }
  ```
- **错误响应**:
  - `404 Not Found`: 测试未找到
  - `403 Forbidden`: 无权限查看这些测试
  - `400 Bad Request`: 参数错误或测试不可比较

---

## 12. 健康检查 API

### 12.1 健康检查
- **路径**: `/health`
- **方法**: `GET`
- **响应**:
  ```json
  {
    "status": "健康",
    "version": "1.0.0",
    "database": "连接正常",
    "uptime": 3600                         // 服务运行时间（秒）
  }
  ```